import {Component, LensRendererExtension} from "@k8slens/extensions";
import React from "react";
import {vulnerabilityReportsStore} from "../vulnerability-report-store";
import {VulnerabilityReport} from "../vulnerability-report"

enum sortBy {
    name = "name",
    namespace = "namespace",
}

export class VulnerabilityReportPage extends React.Component<{ extension: LensRendererExtension }> {

    async componentDidMount() {
        await vulnerabilityReportsStore.loadAll()
    }

    render() {
        return (
            <Component.KubeObjectListLayout
                className="VulnerabilityReports" store={vulnerabilityReportsStore}
                sortingCallbacks={{
                    [sortBy.name]: (report: VulnerabilityReport) => report.getName(),
                    [sortBy.namespace]: (report: VulnerabilityReport) => report.metadata.namespace
                }}
                searchFilters={[
                    (report: VulnerabilityReport) => report.getSearchFields()
                ]}
                renderHeaderTitle="VulnerabilityReports"
                renderTableHeader={[
                    {title: "Name", className: "name", sortBy: sortBy.name},
                    {title: "Namespace", className: "namespace", sortBy: sortBy.namespace},
                ]}
                renderTableContents={(report: VulnerabilityReport) => [
                    report.getName(),
                    report.metadata.namespace
                ]}
            />
        )
    }
}
